# 意思決定記録 - 2025年8月12日

## 決定事項

### 🎯 次の実装：データ同期機能を優先

**全員一致でデータ同期機能の実装を優先することに決定しました。**

## チームの意見まとめ

### Takashi（バックエンド）
- **HangFire推奨** - 統合の容易性と開発効率を重視
- **実装順序提案**: 商品 → 顧客 → 注文（依存関係を考慮）
- **本日の準備完了**: ShopifyApiService実装済み

### Yuki（フロントエンド）
- **データ同期優先に同意** - UI開発の前提条件として重要
- **並行作業可能**: モックデータで画面開発を進められる
- **localhost問題も解決済み**: リダイレクトエラーは修正完了

### Kenji（PM）
- **クリティカルパス**: MVPの中核機能
- **スケジュールリスク回避**: 早期着手が重要
- **開発ページ除外は後回し**: 1日で完了可能

## 実装計画

### 技術選定
**HangFire**を採用
- 理由：ASP.NET Core統合が簡単、管理画面付き、即座に開始可能

### 実装順序（Takashi提案を採用）
1. **商品データ** - 依存関係なし、最もシンプル
2. **顧客データ** - 注文の前提条件
3. **注文データ** - 商品・顧客を参照

### スケジュール

#### 8月13日（火）
- **AM**: HangFire基本設定（Takashi）
- **PM**: 商品データ同期実装（Takashi）
- **並行**: ダッシュボード画面準備（Yuki）

#### 8月14日（水）
- **AM**: 顧客データ同期（Takashi）
- **PM**: 注文データ同期（Takashi）
- **並行**: 同期状況表示画面（Yuki）

#### 8月15日（木）
- **AM**: 統合テスト（全員）
- **PM**: パフォーマンステスト（Takashi）
- **並行**: UI統合（Yuki）

#### 8月16日（金）
- **AM**: GDPR Webhooks実装（Takashi）
- **PM**: 週次レビュー（全員）

## 役割分担

### Takashi
- HangFire実装リード
- データ同期ジョブ開発
- パフォーマンス最適化

### Yuki
- ダッシュボード画面開発
- 同期状況表示UI
- APIクライアント整備

### Kenji
- 全体調整
- テスト計画策定
- ドキュメント更新

## 技術的決定事項

### HangFire設定（Takashi提案）
```csharp
// Program.cs
services.AddHangfire(config => 
    config.UseSqlServerStorage(connectionString)
          .UseRecommendedSerializerSettings());

services.AddHostedService<KeepAliveService>(); // Always On対策
```

### データベースインデックス追加
```sql
CREATE INDEX IX_Orders_StoreId_CreatedAt ON Orders(StoreId, CreatedAt);
CREATE INDEX IX_Customers_StoreId_UpdatedAt ON Customers(StoreId, UpdatedAt);
```

## リスク管理

### 識別されたリスク
1. **Azure App ServiceのAlways On制限**
   - 対策：KeepAliveService実装

2. **大量データの同期**
   - 対策：ページネーション実装済み（Takashi）

3. **Rate Limit**
   - 対策：Pollyリトライポリシー実装済み（Takashi）

## 成功指標

### 技術指標
- [ ] 同期成功率 95%以上
- [ ] 1店舗あたりの同期時間 5分以内
- [ ] エラー率 1%未満

### ビジネス指標
- [ ] 実データでダッシュボード表示可能
- [ ] デモ可能な状態
- [ ] 3店舗以上で動作確認

## コミュニケーション

### 日次スタンドアップ
- 毎朝9:00にtemp.mdで進捗共有
- ブロッカーは即座に報告

### 進捗確認
- 夕方18:00に各自report_[名前].mdを更新

## 次のマイルストーン

**8月15日（木）17:00**
- データ同期機能の完全動作
- ダッシュボードでの実データ表示
- デモ実施

## 備考

- 開発ページ除外は来週対応
- GDPR対応は金曜日に実施
- 負荷テストは木曜日に初回実施

---
決定日時：2025年8月12日 19:30
参加者：Kenji、Takashi、Yuki
記録者：Kenji