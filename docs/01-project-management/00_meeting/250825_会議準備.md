# 2025-08-25 会議準備資料（課金・無料プラン・申請）

作成者: AI Assistant（参考: Kenji資料）

## 目的
- 8/18議事録と8/18-24週間サマリー、`docs/06-shopify/02-課金システム/` の最新仕様を踏まえ、申請準備の意思決定と実施項目を確定する。

## アジェンダ（60分）
1. 前回合意事項・進捗確認（5分）
2. 課金モデル最終確認（価格・トライアル）（10分）
3. 実装状況と残タスク（課金API・Webhook・無料プラン）（15分）
4. テスト計画（0円テスト・E2E・Webhook）（10分）
5. 申請準備（素材・$19支払い・スケジュール）（10分）
6. 決定事項・アクション割当（10分）

## 説明すべきポイント（要点）
- 設計方針（プラン選択のタイミング）
  - インストール完了（OAuth/初期設定直後）にプラン選択。インストール同意画面内では課金遷移しない。
- 課金APIの採用と仕様
  - GraphQL Admin API `appSubscriptionCreate` を採用。`trialDays`/`test`対応、RESTのRACはレガシー。
  - 重要Webhook: `app_subscriptions/update`, `app_subscriptions/cancelled`, `app/uninstalled`。
- 無料プラン機能選択の仕様
  - 3機能のうち1つ（休眠顧客/前年比/購入回数）を選択。30日縛り、ゲーティングはサーバー側で厳格に。
  - DB: `UserFeatureSelections` 他、監査/冪等/楽観ロック対応。
- DDL/マイグレーション運用
  - DDLは `docs/04-development/03-データベース/マイグレーション/` を正本に統一。tracking.md 更新ルール順守。
- テスト戦略
  - TestMode=trueの0円テスト手順、E2Eケース、Webhook署名検証と冪等性。
- スケジュール目標
  - 週間サマリー上のマイルストーン: 8/30開発完了、9/2申請提出（要再確認）。

## 参照資料（画面共有用）
- 議事録: `docs/01-project-management/00_meeting/250818_会議議事録.md`
- 週間サマリー: `docs/worklog/2025/08/2025-08-18-24-weekly-summary.md`
- 技術仕様（課金）
  - `docs/06-shopify/02-課金システム/02-技術仕様/GraphQL_API最新仕様.md`
  - `docs/06-shopify/02-課金システム/02-技術仕様/Shopifyサブスクリプション技術ガイド.md`
  - `docs/06-shopify/02-課金システム/02-技術仕様/フロー図解.md`
  - `docs/06-shopify/02-課金システム/04-理解と運用/Shopify課金システム完全ガイド.md`
- テスト関連
  - `docs/06-shopify/02-課金システム/03-実装管理/テスト手順書-課金と無料プラン.md`
  - `docs/06-shopify/02-課金システム/03-実装管理/テスト仕様書-課金と無料プラン.md`
  - `docs/06-shopify/02-課金システム/04-理解と運用/課金0円テスト完全手順書.md`
- 無料プラン（要件/設計/UI/実装）
  - `docs/06-shopify/02-課金システム/05-無料プラン機能制限/要件定義と設計.md`
  - `docs/06-shopify/02-課金システム/05-無料プラン機能制限/技術設計詳細書.md`
  - `docs/06-shopify/02-課金システム/05-無料プラン機能制限/UIデザイン仕様.md`
  - `docs/06-shopify/02-課金システム/05-無料プラン機能制限/実装タスクリスト.md`

## デモ計画（画面・台本）
1) 無料プラン機能選択
   - 画面: `/billing/free-plan-setup`
   - 台本: 3機能から1つ選択→`UserFeatureSelections` 反映→未選択機能アクセスで403/Upgrade誘導確認。
2) 課金プラン選択〜承認
   - 画面: `/settings/billing`
   - 台本: プラン選択→承認URL遷移（TEST/$0.00 表示）→承認→`StoreSubscriptions` active/Webhook受信確認。
3) アップグレード/キャンセル
   - 画面: `/billing/subscription`（想定）
   - 台本: アップグレード→`app_subscriptions/update` 反映、キャンセル→`cancelled` 反映・ゲーティング復帰。

## 決定が必要な項目（提案含む）
- 価格・トライアル: $50/$80/$100、トライアル7/14日の最終確定（提案: Starter/Pro 7日、Enterprise 14日）。
- 申請スケジュール: 8/30開発完了、9/2申請提出の維持可否。
- 0円テストの実施計画と担当（テストストア/カード手当含む）。
- 申請素材の担当/期限（アイコン、スクショ、説明文、規約/PP HTML公開）。
- 課金APIのMVP範囲確定（キャンセル/アップグレードの扱い、日割りはShopify依存）。

## 残タスク（優先度順・担当案）
- 課金API実装/検証（`SubscriptionController`/Service）: Takashi（最優先）
- Webhook 3種の最終検証（署名・冪等）: Takashi
- 無料プランAPI/ミドルウェア統合とUI結合: Yuki
- DDL追補と tracking.md 更新（Dev/Stg適用状況記録）: Takashi
- 0円E2Eテスト実施・証跡保存: 全員（主担当: QA）
- 申請素材の確定とアップロード: Kenji主導

## リスク/ブロッカーと対策
- Webhook遅延/重複: 冪等キーと再処理キューで吸収、テストで遅延許容値確認。
- レート制限: バックオフ/リトライ（Polly）設定確認。
- 申請時要件の見落とし: チェックリストで事前確認、疑義は事前問い合わせ。

---

# 2025-08-25 顧客向け 会議アジェンダ（ECレンジャー）

作成: AI Assistant／確認: Kenji
対象: ご担当者様（ビジネス/技術）

## 目的
- 最小機能での申請準備状況を共有し、公開に向けた最終合意を得る。

## 進行（45分）
1. ご挨拶・本日のゴール（3分）
2. 進捗サマリー（5分）
   - 無料プラン機能選択：仕様確定/実装進行
   - 課金フロー：Shopify App Subscription（GraphQL）採用、テスト計画
3. 体験デモ（15分）
   - 無料プラン機能選択フロー（3機能から1つ・月1回変更）
   - 課金承認フロー（テストモード：$0.00表示）
4. 価格・トライアル案の確認（7分）
   - 案：$50 / $80 / $100、トライアル7/7/14日
5. リリース計画とスケジュール（7分）
   - 8/30 開発完了 → 9/2 申請提出（目標）
6. ご確認事項・Q&A（8分）
   - 運用ルール/サポート窓口/契約関連

## 本日の配布資料（共有）
- 製品概要と料金案（1枚）
- 体験デモの流れ（1枚）
- スケジュール（1枚）

## デモ概要（要点）
- 無料プラン体験：3機能のうち1機能を選択して画面体験
- 課金承認：プラン選択 → Shopify承認画面（TEST/$0.00） → 承認後の状態確認

## 本日ご決定いただきたいこと
- 価格と無料トライアル日数の最終案
- 申請提出スケジュール（提出日・ご担当）
- 初期リリース範囲（MVP）

## 事前のお願い
- テスト用ストア（または閲覧権限）のご用意
- 社内レビュー用の資料共有先（メール/Slack等）

---
ご不明点は会議中に遠慮なくお知らせください。体験デモ中心で短時間・高密度に進行します。


