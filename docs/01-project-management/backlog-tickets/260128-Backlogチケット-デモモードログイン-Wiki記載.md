# Backlogチケット: デモモードと閲覧機能の改善

## タイトル
デモモード閲覧機能の認証システム改善とWiki整備

## 種別
機能改善・ドキュメント

## 優先度
中

## 概要

開発者側がクライアントのデータを閲覧するためのデモモード機能について、認証システムの改善とWiki整備を実施する。

現在は簡易的なパスワード認証のみで実装されているが、正式な認証システムへの移行と、使用方法の文書化が必要。

## 背景

### ビジネス要件

Shopify管理画面からのOAuth認証でアプリ呼び出しではなく、**許可された第三者がインストール済みのストアのデータを参照できるようにしたい**という要望がある。

**具体的なユースケース**:
- 開発者側がクライアントのデータを閲覧して、問題の調査やサポートを行う
- クライアント（例: 鳥谷さん）のデータを許可を得て閲覧する
- インストール済みのストアのデータを、Shopify管理画面を経由せずに参照する

### 現状

- ✅ デモモード機能は既に実装済み
- ✅ ショップドメインを指定してパスワードを入れる参照用の入り口が作成済み
- ⚠️ 認証は簡易的なパスワード入力のみ
- ⚠️ 正式な認証システムは未構築
- ⚠️ 本番環境には未デプロイ
- ⚠️ Wikiへの使用方法の記載が未完了

### 課題

1. **認証システムの改善が必要**
   - 簡易的なパスワード認証のみでは、セキュリティレベルが不十分な可能性
   - 正式な認証システムの構築が必要

2. **Wiki整備が必要**
   - デモモードログインの使用方法が文書化されていない
   - パスワードの取り扱い方法が未記載
   - セキュリティ上の注意事項が未記載

3. **クライアントデータ閲覧の許可取得**
   - デモモードで鳥谷さんのデータを閲覧させてもらう許可をいただけるか（2026年1月15日相談予定）

## 対応内容

### Phase 1: 認証システムの改善

**目標**: 簡易的なパスワード認証から正式な認証システムへの移行

**対応内容**:
1. **認証方式の見直し**
   - 現在のパスワード認証の評価
   - より堅牢な認証方式の検討
   - 必要に応じてユーザー管理機能の追加

2. **セキュリティ強化**
   - 多要素認証（MFA）の検討
   - アクセスログの記録・監視機能
   - IP制限機能の強化
   - アクセス権限の細分化

3. **認証情報の管理改善**
   - Azure Key Vaultへの移行検討
   - パスワードローテーション機能
   - セキュアな認証情報の管理

**実装方針**:
- 既存のデモモード機能を壊さないよう段階的に改善
- 本番環境デプロイ前に十分なテストを実施
- セキュリティレビューを実施

### Phase 2: Wiki整備

**目標**: デモモードログインの使用方法とセキュリティ注意事項の文書化

**対応内容**:
1. **ログイン方法の記載**
   - デモモードログインの手順
   - ショップドメインの指定方法
   - ログイン後の画面遷移の説明

2. **パスワード管理の記載**
   - パスワードの管理方法
   - 限定公開であることの明記
   - 有効期限の明記
   - セキュリティ上の注意事項

3. **認証情報の管理**
   - 認証情報を後で入れてもらう手順
   - パスワード変更時の手順
   - アクセス権限の管理方法

### Phase 3: クライアントデータ閲覧の許可取得

**目標**: 鳥谷さんのデータを閲覧する許可を取得

**対応内容**:
1. **許可取得の相談**
   - 相談予定日: 2026年1月15日
   - デモモードの用途と目的を説明
   - セキュリティ対策を説明
   - データの取り扱い方法を説明

2. **許可取得後の対応**
   - 許可取得後、デモモードでデータ閲覧を開始
   - アクセスログの記録
   - 定期的なレビュー

## 完了条件

### Phase 1: 認証システムの改善
- [ ] 現在の認証システムの評価・レビュー
- [ ] 認証方式の改善案の作成
- [ ] セキュリティ強化の実装
  - [ ] アクセスログの記録・監視機能
  - [ ] IP制限機能の強化
  - [ ] 必要に応じて多要素認証の実装
- [ ] 認証情報の管理改善（Azure Key Vaultへの移行検討）
- [ ] テスト環境での動作確認
- [ ] 本番環境デプロイ前のレビュー

### Phase 2: Wiki整備
- [ ] Wikiにデモモードログインの手順を記載
- [ ] ショップドメインの指定方法を明記
- [ ] パスワードの取り扱い方法を記載（限定公開、期限明記）
- [ ] セキュリティ上の注意事項を記載
- [ ] 認証情報の管理方法を記載
- [ ] パスワード変更時の手順を記載
- [ ] アクセス権限の管理方法を記載

### Phase 3: クライアントデータ閲覧の許可取得
- [ ] 鳥谷さんへの相談（2026年1月15日予定）
- [ ] デモモードの用途と目的の説明
- [ ] セキュリティ対策の説明
- [ ] データの取り扱い方法の説明
- [ ] 許可取得の確認
- [ ] 許可取得後のアクセス開始
- [ ] アクセスログの記録開始

## 関連資料
- 議事録: `docs/01-project-management/00_meeting/260128-打合せ議事録.md` セクション7
- デモモード認証フロー設計書: `docs/05-development/09-認証・セキュリティ/デモモード認証フロー設計書.md`
- デモログインと開発者ログインの違い: `docs/05-development/08-デバッグ・トラブル/01-problem-analysis/2026-01/demo-vs-developer-login-difference.md`

## 対応者
福田さん

## 関連チケット
- 議事録のアクションアイテム: 2026-01-28 打合せ議事録 セクション7、8

## 備考
- **重要**: 本番環境には未デプロイのため、デプロイ前に十分なセキュリティレビューが必要
- クライアントデータの閲覧は許可取得後に開始すること
- パスワードの取り扱いには十分注意すること
- Wikiへの記載は限定公開で行うこと
- 認証システムの改善は段階的に実施し、既存機能を壊さないよう注意すること

## 相談・許可取得スケジュール
- **相談予定日**: 2026年1月15日
- **対象**: 鳥谷さんのデータ閲覧許可
- **相談内容**:
  - デモモードの用途と目的
  - セキュリティ対策の説明
  - データの取り扱い方法
  - アクセスログの記録方法
