# Shopify AIアプリ データベースモデル一覧

## 用語補足

- **ストア運営者**：アプリを利用するShopifyストアの運営者（アプリ提供者から見た顧客）
- **消費者**：Shopifyストアで買い物をするエンドユーザー（ストア運営者から見た顧客）
- **データ管理原則**：Shopify APIで直接取得可能な生データは保存せず、二次加工データや分析結果のみを保存


## 1. ストア運営者・消費者関連モデル

| モデル名             | 説明                             | 代表的な項目                    | 備考                          |
| -------------------- | -------------------------------- | ------------------------------- | ----------------------------- |
| ストア運営者マスター | アプリを利用するストア運営者情報 | ストアID、ストア名、プラン      | アプリ利用者の基本情報        |
| 消費者分析データ     | 消費者の分析結果を保存           | 消費者ID、購買傾向、セグメント  | 生データはShopify APIから取得 |
| 消費者セグメント     | 消費者グループの定義を管理       | セグメント名、条件、消費者数    | 分析・DM配信用のグループ定義  |
| LTV分析結果          | 消費者の生涯価値分析データ       | 消費者ID、LTVスコア、将来予測値 | 分析結果のみ保存              |
| 放置カート分析       | カート放棄の分析結果             | 消費者ID、放棄回数、傾向        | 分析結果のみ保存              |


## 2. 商品関連モデル

| モデル名         | 説明                   | 代表的な項目                     | 備考                          |
| ---------------- | ---------------------- | -------------------------------- | ----------------------------- |
| 商品分析データ   | 商品の分析結果を保存   | 商品ID、人気度、トレンド         | 生データはShopify APIから取得 |
| 商品閲覧統計     | 商品の閲覧データを集計 | 商品ID、閲覧数、CTR、CV率        | 集計・分析結果のみ保存        |
| 商品購入パターン | 商品間の関連性を分析   | 主商品ID、関連商品ID、同時購入率 | 分析結果のみ保存              |
| 購入順序分析     | 消費者の購入順序を分析 | 消費者ID、購入順序パターン       | 分析結果のみ保存              |


## 3. 注文関連モデル

| モデル名         | 説明                     | 代表的な項目                 | 備考                          |
| ---------------- | ------------------------ | ---------------------------- | ----------------------------- |
| 注文分析データ   | 注文の分析結果を保存     | 期間、売上傾向、平均単価     | 生データはShopify APIから取得 |
| 購入金額分析     | 購入金額の統計データ     | 消費者ID、期間、購入総額     | 集計・分析結果のみ保存        |
| リピート購入分析 | 商品のリピート購入を分析 | 商品ID、リピート率、平均間隔 | 分析結果のみ保存              |


## 4. DM発送関連モデル

| モデル名       | 説明                     | 代表的な項目                       | 備考                   |
| -------------- | ------------------------ | ---------------------------------- | ---------------------- |
| DM発送マスター | DM発送の基本情報を管理   | 発送ID、発送名、ステータス         | アプリ独自機能のデータ |
| DM宛名グループ | DM送付先グループを管理   | グループ名、抽出条件、消費者数     | アプリ独自機能のデータ |
| DM掲載商品     | DMに掲載する商品情報     | DM ID、商品ID、掲載順序            | アプリ独自機能のデータ |
| DMテンプレート | DMのデザインテンプレート | テンプレート名、タイプ、レイアウト | アプリ独自機能のデータ |
| DM効果測定     | DMの効果を測定・分析     | DM ID、反応率、売上金額、ROI       | 分析結果のみ保存       |


## 5. AI分析関連モデル

| モデル名                 | 説明                     | 代表的な項目                   | 備考                   |
| ------------------------ | ------------------------ | ------------------------------ | ---------------------- |
| AIモデル設定             | AI分析モデルの設定を管理 | モデル名、タイプ、パラメータ   | アプリ独自機能のデータ |
| AIプロンプトテンプレート | AIへの指示テンプレート   | テンプレート名、プロンプト内容 | アプリ独自機能のデータ |
| AI分析結果               | AI分析の実行結果を保存   | 分析タイプ、結果、信頼度       | 分析結果のみ保存       |
| AIレコメンデーション     | AI推奨商品情報を管理     | 消費者ID、推奨商品、推奨理由   | 分析結果のみ保存       |


## 6. システム管理モデル

| モデル名             | 説明                       | 代表的な項目                 | 備考                   |
| -------------------- | -------------------------- | ---------------------------- | ---------------------- |
| ストア連携設定       | Shopifyストア連携情報      | ストアID、APIアクセス情報    | アプリ運用に必要な設定 |
| アプリ設定           | アプリケーション設定を管理 | 設定キー、設定値、説明       | アプリ運用に必要な設定 |
| APIリクエストログ    | 重要なAPI通信ログを記録    | エンドポイント、結果、エラー | 問題診断用のみ保存     |
| エラーログ           | システムエラーを記録       | エラーレベル、メッセージ     | 問題診断用のみ保存     |
| データ同期ステータス | データ同期状況を管理       | 同期タイプ、ステータス       | 同期管理用のみ保存     |


## 7. ユーザー管理モデル

| モデル名       | 説明                     | 代表的な項目                 | 備考                   |
| -------------- | ------------------------ | ---------------------------- | ---------------------- |
| アプリユーザー | アプリ操作者情報を管理   | ユーザーID、メール、役割     | ストア運営者の従業員等 |
| ユーザー設定   | ユーザー個別の設定を管理 | ユーザーID、設定キー、設定値 | アプリ操作者の設定     |


## データ管理の原則

1. **保存するデータ**：

1. アプリ独自の機能に必要なデータ（DM設定、AI設定など）
2. 分析結果や集計データ（LTV分析、商品関連性など）
3. システム運用に必要な設定やログ



2. **保存しないデータ**：

1. Shopify APIで直接取得可能な生データ（消費者基本情報、商品基本情報、注文履歴など）
2. 頻繁に変更される可能性のあるデータ（在庫数、価格など）



3. **データ取得方針**：

1. 分析や表示が必要な時点でShopify APIから最新データを取得
2. 必要に応じてキャッシュを活用するが、永続的には保存しない