2025-08-02-EmergencyIndexes.sql
Developmentも昨日実行済みです

# データベース移行管理ドキュメント

## 概要
データベース変更スクリプトの管理と、環境別の適用状況を追跡するためのドキュメント。

## ディレクトリ構造
```
docs/04-development/
├── database-migrations/
│   ├── 2025-08-02-EmergencyIndexes.sql
│   ├── 2025-08-XX-[変更内容].sql
│   └── README.md
└── database-migration-tracking.md (本ファイル)
```

## 移行スクリプト一覧と適用状況

| スクリプト名 | 作成日 | 作成者 | 内容 | Development | Staging | Production |
|------------|--------|--------|------|-------------|---------|------------|
| 2025-08-02-EmergencyIndexes.sql | 2025-08-02 | TAKASHI | OrderItemsインデックス追加 | ✅ 適用済 (2025-08-04) | ⏳ 未適用 | ⏳ 未適用 |
| 2025-08-05-AddInitialSetupFeature.sql | 2025-08-05 | TAKASHI | 初期設定機能（SyncStatusテーブル、Storesテーブル更新） | ✅ 適用済 (2025-08-05 10:00) | ⏳ 未適用 | ⏳ 未適用 |

## 適用手順

### 1. 開発環境での確認
```bash
# スクリプト実行
sqlcmd -S [server] -d [database] -i [script.sql]

# 実行結果確認
# - エラーがないこと
# - 想定通りの変更が適用されたこと
```

### 2. ステージング環境への適用
- Azure Portal SQL Database クエリエディタを使用
- または sqlcmd コマンドを使用

### 3. 本番環境への適用
- 必ずバックアップを取得してから実行
- メンテナンス時間内に実施
- ロールバック手順を準備

## 記録ルール

### スクリプト作成時
1. `docs/04-development/database-migrations/` に保存
2. ファイル名: `YYYY-MM-DD-[説明].sql`
3. スクリプト内にコメントで以下を記載：
   ```sql
   -- 作成日: 2025-08-02
   -- 作成者: TAKASHI
   -- 目的: OrderItemsテーブルのパフォーマンス改善
   -- 影響: 読み取りクエリの高速化
   ```

### 適用時
1. 本ファイルの表を更新
2. 適用日時を記録
3. 問題があれば備考欄に記載

## チェックリスト

### 適用前
- [ ] スクリプトのレビュー完了
- [ ] 開発環境でのテスト完了
- [ ] バックアップ取得（本番のみ）
- [ ] ロールバック手順準備

### 適用後
- [ ] エラーがないことを確認
- [ ] アプリケーション動作確認
- [ ] パフォーマンス改善を確認
- [ ] 本ドキュメント更新

---

最終更新: 2025-08-05
管理者: 福田
更新者: Kenji（AIチーム）