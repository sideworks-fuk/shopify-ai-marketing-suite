```mermaid
erDiagram
    %% Shopify AI Marketing Suite - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ ERå›³ (æ¦‚è¦ç‰ˆ)
    %% ä½œæˆæ—¥: 2025-07-27
    %% ä½œæˆè€…: AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚±ãƒ³ã‚¸
    
    %% ã‚¹ãƒˆã‚¢ãƒã‚¹ã‚¿ãƒ¼ï¼ˆãƒãƒ«ãƒã‚¹ãƒˆã‚¢å¯¾å¿œã®ä¸­æ ¸ï¼‰
    Stores {
        int Id PK "ä¸»ã‚­ãƒ¼"
        string Name "ã‚¹ãƒˆã‚¢å"
        string Domain "ãƒ‰ãƒ¡ã‚¤ãƒ³"
        string ShopifyShopId "Shopifyåº—èˆ—ID"
        datetime CreatedAt "ä½œæˆæ—¥æ™‚"
        datetime UpdatedAt "æ›´æ–°æ—¥æ™‚"
    }
    
    %% é¡§å®¢ãƒã‚¹ã‚¿ãƒ¼ï¼ˆåŒ¿ååŒ–æ¸ˆã¿ï¼‰
    Customers {
        int Id PK "ä¸»ã‚­ãƒ¼"
        int StoreId FK "ã‚¹ãƒˆã‚¢ID"
        string ShopifyCustomerId "Shopifyé¡§å®¢ID"
        string FirstName "å"
        string LastName "å§“"
        string Email "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹"
        string Phone "é›»è©±ç•ªå·"
        string City "å¸‚åŒºç”ºæ‘"
        string ProvinceCode "éƒ½é“åºœçœŒã‚³ãƒ¼ãƒ‰"
        string CountryCode "å›½ã‚³ãƒ¼ãƒ‰"
        bool AcceptsEmailMarketing "ãƒ¡ãƒ¼ãƒ«é…ä¿¡è¨±å¯"
        bool AcceptsSMSMarketing "SMSé…ä¿¡è¨±å¯"
        decimal TotalSpent "ç´¯è¨ˆè³¼å…¥é¡"
        int TotalOrders "ç´¯è¨ˆæ³¨æ–‡æ•°"
        string CustomerSegment "é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ"
        datetime CreatedAt "ä½œæˆæ—¥æ™‚"
        datetime UpdatedAt "æ›´æ–°æ—¥æ™‚"
    }
    
    %% å•†å“ãƒã‚¹ã‚¿ãƒ¼
    Products {
        int Id PK "ä¸»ã‚­ãƒ¼"
        int StoreId FK "ã‚¹ãƒˆã‚¢ID"
        string Title "å•†å“å"
        string Handle "å•†å“ãƒãƒ³ãƒ‰ãƒ«"
        string Description "å•†å“èª¬æ˜"
        string Category "ã‚«ãƒ†ã‚´ãƒª"
        string Vendor "ãƒ™ãƒ³ãƒ€ãƒ¼"
        string ProductType "å•†å“ã‚¿ã‚¤ãƒ—"
        int InventoryQuantity "åœ¨åº«æ•°"
        datetime CreatedAt "ä½œæˆæ—¥æ™‚"
        datetime UpdatedAt "æ›´æ–°æ—¥æ™‚"
    }
    
    %% å•†å“ãƒãƒªã‚¢ãƒ³ãƒˆ
    ProductVariants {
        int Id PK "ä¸»ã‚­ãƒ¼"
        int ProductId FK "å•†å“ID"
        string Sku "SKU"
        decimal Price "ä¾¡æ ¼"
        decimal CompareAtPrice "æ¯”è¼ƒä¾¡æ ¼"
        int InventoryQuantity "åœ¨åº«æ•°"
        string Option1Name "ã‚ªãƒ—ã‚·ãƒ§ãƒ³1å"
        string Option1Value "ã‚ªãƒ—ã‚·ãƒ§ãƒ³1å€¤"
        string Option2Name "ã‚ªãƒ—ã‚·ãƒ§ãƒ³2å"  
        string Option2Value "ã‚ªãƒ—ã‚·ãƒ§ãƒ³2å€¤"
        string Option3Name "ã‚ªãƒ—ã‚·ãƒ§ãƒ³3å"
        string Option3Value "ã‚ªãƒ—ã‚·ãƒ§ãƒ³3å€¤"
        string Barcode "ãƒãƒ¼ã‚³ãƒ¼ãƒ‰"
        decimal Weight "é‡é‡"
        string WeightUnit "é‡é‡å˜ä½"
        bool RequiresShipping "é…é€è¦å¦"
        bool Taxable "èª²ç¨å¯¾è±¡"
        datetime CreatedAt "ä½œæˆæ—¥æ™‚"
        datetime UpdatedAt "æ›´æ–°æ—¥æ™‚"
    }
    
    %% æ³¨æ–‡ï¼ˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼‰
    Orders {
        int Id PK "ä¸»ã‚­ãƒ¼"
        int StoreId FK "ã‚¹ãƒˆã‚¢ID"
        string OrderNumber UK "æ³¨æ–‡ç•ªå·(ãƒ¦ãƒ‹ãƒ¼ã‚¯)"
        int CustomerId FK "é¡§å®¢ID"
        decimal TotalPrice "åˆè¨ˆé‡‘é¡(ç¨è¾¼)"
        decimal SubtotalPrice "å°è¨ˆé‡‘é¡(ç¨æŠœ)"
        decimal TaxPrice "ç¨é¡"
        string Currency "é€šè²¨"
        string Status "æ³¨æ–‡ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"
        string FinancialStatus "æ”¯æ‰•ã„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹"
        datetime CreatedAt "æ³¨æ–‡æ—¥æ™‚"
        datetime UpdatedAt "æ›´æ–°æ—¥æ™‚"
    }
    
    %% æ³¨æ–‡æ˜ç´°ï¼ˆã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆå‹ã®ä¸­æ ¸ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰
    OrderItems {
        int Id PK "ä¸»ã‚­ãƒ¼"
        int OrderId FK "æ³¨æ–‡ID"
        string ProductId "å•†å“ID(å‚ç…§ç”¨,NULLè¨±å¯)"
        string ProductTitle "å•†å“å(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string ProductHandle "å•†å“ãƒãƒ³ãƒ‰ãƒ«(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string ProductVendor "ãƒ™ãƒ³ãƒ€ãƒ¼(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string ProductType "å•†å“ã‚¿ã‚¤ãƒ—(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string Sku "SKU(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string VariantTitle "ãƒãƒªã‚¢ãƒ³ãƒˆå(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        decimal Price "å˜ä¾¡(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        decimal CompareAtPrice "æ¯”è¼ƒä¾¡æ ¼(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        int Quantity "æ•°é‡"
        decimal TotalPrice "å°è¨ˆ"
        string Option1Name "ã‚ªãƒ—ã‚·ãƒ§ãƒ³1å(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string Option1Value "ã‚ªãƒ—ã‚·ãƒ§ãƒ³1å€¤(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string Option2Name "ã‚ªãƒ—ã‚·ãƒ§ãƒ³2å(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string Option2Value "ã‚ªãƒ—ã‚·ãƒ§ãƒ³2å€¤(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string Option3Name "ã‚ªãƒ—ã‚·ãƒ§ãƒ³3å(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        string Option3Value "ã‚ªãƒ—ã‚·ãƒ§ãƒ³3å€¤(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        bool RequiresShipping "é…é€è¦å¦(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        bool Taxable "èª²ç¨å¯¾è±¡(ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ)"
        datetime CreatedAt "ä½œæˆæ—¥æ™‚"
        datetime UpdatedAt "æ›´æ–°æ—¥æ™‚"
    }
    
    %% ======================
    %% ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—å®šç¾©
    %% ======================
    
    %% ãƒãƒ«ãƒã‚¹ãƒˆã‚¢å¯¾å¿œã®ä¸­æ ¸é–¢ä¿‚
    Stores ||--o{ Customers : "ç®¡ç†"
    Stores ||--o{ Products : "æ‰€æœ‰"
    Stores ||--o{ Orders : "å—æ³¨"
    
    %% é¡§å®¢ã¨æ³¨æ–‡ã®é–¢ä¿‚
    Customers ||--o{ Orders : "æ³¨æ–‡å±¥æ­´"
    
    %% å•†å“ã¨ãƒãƒªã‚¢ãƒ³ãƒˆã®é–¢ä¿‚
    Products ||--o{ ProductVariants : "ãƒãƒªã‚¢ãƒ³ãƒˆå±•é–‹"
    
    %% æ³¨æ–‡ã¨æ˜ç´°ã®é–¢ä¿‚ï¼ˆæœ€é‡è¦ï¼‰
    Orders ||--|{ OrderItems : "æ˜ç´°å±•é–‹"
    
    %% é‡è¦ï¼šOrderItemsã¨å•†å“ã®é–¢ä¿‚ï¼ˆå‚ç…§ã®ã¿ã€ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆè¨­è¨ˆï¼‰
    Products ||--o{ OrderItems : "å‚ç…§(åˆ†æç”¨,NULLè¨±å¯)"
    ProductVariants ||--o{ OrderItems : "å‚ç…§(åˆ†æç”¨,NULLè¨±å¯)"
```

**ğŸ¯ é‡è¦ãªè¨­è¨ˆãƒã‚¤ãƒ³ãƒˆ**

1. **ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆè¨­è¨ˆã®ä¸­æ ¸**
   - `OrderItems` ã¯å•†å“æƒ…å ±ã‚’å®Œå…¨ã«ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆä¿å­˜
   - å•†å“ãƒã‚¹ã‚¿ãƒ¼å¤‰æ›´ã®å½±éŸ¿ã‚’å—ã‘ãªã„å–å¼•å±¥æ­´

2. **ãƒãƒ«ãƒã‚¹ãƒˆã‚¢å¯¾å¿œ**
   - å…¨ãƒã‚¹ã‚¿ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã« `StoreId` ã§ãƒ‡ãƒ¼ã‚¿åˆ†é›¢
   - ã‚¹ãƒˆã‚¢å‰Šé™¤ã¯ `NoAction` ã§æ…é‡ã«å¯¾å¿œ

3. **å‚ç…§æ•´åˆæ€§**
   - å¿…é ˆé–¢ä¿‚: Orders â†” Customers, Orders â†” OrderItems
   - ä»»æ„é–¢ä¿‚: OrderItems â†’ Products (åˆ†æç”¨ã€NULLè¨±å¯)

4. **å‰Šé™¤ãƒãƒªã‚·ãƒ¼**
   - `Cascade`: è¦ªå‰Šé™¤æ™‚ã®å­è‡ªå‹•å‰Šé™¤ï¼ˆOrders â†’ OrderItemsï¼‰
   - `NoAction`: æ‰‹å‹•å¯¾å¿œãŒå¿…è¦ï¼ˆStoresé–¢é€£ï¼‰

**ğŸ“Š åˆ†æã‚¯ã‚¨ãƒªã§ã®æ´»ç”¨æ–¹é‡**
- åŸºæœ¬: `OrderItems` ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
- æ‹¡å¼µ: `ProductId` ã§ç¾åœ¨ã®å•†å“ãƒã‚¹ã‚¿ãƒ¼ã¨çµåˆ
- æœŸé–“: `Orders.CreatedAt` ã§æ™‚ç³»åˆ—åˆ†æ
- ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ: `Customers` ã®å±æ€§ã§é¡§å®¢åˆ†æ