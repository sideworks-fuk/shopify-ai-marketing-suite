## バックエンドサービスクラス技術レビューの指示

### 作業概要
APIに紐づくサービスクラス群の包括的な技術レビューを実施してください。今後の開発継続を考慮し、技術的負債の早期発見と解消、およびDDD（ドメイン駆動設計）の観点からの改善提案を求めます。

### レビュー対象
```
backend/ShopifyTestApi/Services/
├── AnalyticsService.cs
├── CustomerService.cs
├── DormantCustomerService.cs
├── OrderService.cs
├── ProductService.cs
├── PurchaseAnalyticsService.cs
├── YearOverYearService.cs
└── [その他のサービスクラス]
```

### レビュー観点

#### 1. 技術的負債の特定
- [ ] 重複コードの有無
- [ ] 過度に複雑なメソッド（循環的複雑度）
- [ ] 不適切な責務の混在
- [ ] テスタビリティの問題
- [ ] パフォーマンスボトルネック
- [ ] エラーハンドリングの一貫性

#### 2. DDD適用状況の評価
- [ ] ドメインモデルの適切性
- [ ] 集約の境界設定
- [ ] リポジトリパターンの実装
- [ ] ドメインサービスとアプリケーションサービスの分離
- [ ] 値オブジェクトの活用
- [ ] ドメインイベントの考慮

#### 3. 設計原則の遵守
- [ ] SOLID原則の適用状況
- [ ] 依存性注入の適切な使用
- [ ] インターフェースの抽象度
- [ ] 凝集度と結合度のバランス

### 成果物

#### A. レビューレポート
**ファイル**: `docs/technical-review/service-layer-review-2025-01.md`

以下の構成で作成：
```markdown
# サービスレイヤー技術レビュー

## エグゼクティブサマリー
- 重大な問題: X件
- 中程度の問題: Y件
- 改善提案: Z件

## 技術的負債一覧
### 優先度：高
1. [問題の詳細と影響範囲]
   - 該当ファイル：
   - 推奨対応：
   - 工数見積：

### 優先度：中
[...]

## DDD観点での改善提案
### 1. ドメインモデルの再構成
[具体的な提案]

### 2. 集約の見直し
[具体的な提案]

## リファクタリング計画
### Phase 1（即座に対応すべき）
- タスク一覧
- 予想工数

### Phase 2（計画的に対応）
- タスク一覧
- 予想工数
```

#### B. 改善実装サンプル
重要な改善については、Before/Afterのコードサンプルを提供してください。

```csharp
// Before: 問題のあるコード
public class OrderService 
{
    // 責務が多すぎる例
}

// After: 改善後のコード
public class OrderApplicationService 
{
    // 適切に分離された例
}
```

### 評価基準

#### 🔴 重大（即座に対応）
- セキュリティリスク
- データ整合性の問題
- 重大なパフォーマンス問題
- 将来の拡張を著しく阻害

#### 🟡 中程度（計画的に対応）
- コードの重複
- 設計原則の違反
- テストの困難性
- 軽微なパフォーマンス問題

#### 🟢 軽微（時間があれば対応）
- 命名規則の不統一
- コメントの不足
- 軽微なリファクタリング

### 追加調査項目
1. **依存関係の分析**
   - サービス間の依存関係図を作成
   - 循環依存の検出

2. **データフローの確認**
   - DTOとドメインモデルの変換箇所
   - トランザクション境界の適切性

3. **拡張性の評価**
   - 新機能追加時の影響範囲
   - インターフェースの柔軟性

### 完了条件
- [ ] 全サービスクラスのレビュー完了
- [ ] 技術的負債の優先順位付け
- [ ] DDD適用状況の評価
- [ ] 改善提案の文書化
- [ ] リファクタリング計画の策定

### 注意事項
- 現在進行中の開発への影響を考慮
- 段階的な改善アプローチを提案
- ROIを意識した優先順位付け

期限：3日以内