# Shopify App Store 公開申請タスクリスト

**作成日**: 2025-10-18  
**最終更新**: 2025-11-12（最新の公式情報に基づいて更新）  
**目標申請日**: 未定（タスク完了後）

**注意**: このドキュメントは最新のShopify公式情報に基づいて更新されています。特に「審査用テスト環境」セクション（7.3）は、2025年11月12日に最新の公式要件に基づいて大幅に更新されました。

---

## 📋 タスク概要

このドキュメントは、Shopify App Storeへの公開申請に向けた包括的なタスクリストです。既存のチェックリストを最新の実装状況に基づいて更新・統合しています。

---

## 🎯 優先度定義

- 🔴 **最優先（申請ブロッカー）**: これが完了しないと申請不可
- 🟡 **重要（申請前推奨）**: 完了推奨、未完了でも申請可能だがリスクあり
- 🟢 **推奨（申請後対応可）**: 申請後でも対応可能

---

## 1. 技術要件 🔴

### 1.1 OAuth 2.0 認証

- [x] OAuth認証フローが正常に動作する
- [x] アクセストークンが暗号化されて保存される
- [x] State検証によるCSRF対策が実装されている
- [x] リダイレクトURLがHTTPSで提供されている
- [ ] **本番環境での動作確認**（Staging/Production環境でテスト）

**確認方法**: 
- 開発ストアでインストール→認証→ダッシュボード表示まで確認
- Application Insightsで認証エラーがないことを確認

**担当**: Takashi  
**見積**: 0.5日

---

### 1.2 GDPR必須Webhook

#### 実装状況確認

- [x] `app/uninstalled` - アプリアンインストール時の処理
- [x] `customers/redact` - 顧客データ削除要求の処理
- [x] `shop/redact` - ショップデータ削除要求の処理
- [x] `customers/data_request` - 顧客データ開示要求の処理
- [x] 全てのWebhookが5秒以内に200を返す
- [x] HMAC署名検証が全てのWebhookで実装されている

#### 残作業

- [ ] 🔴 **本番削除スケジューリングの実装完了**
  - 対象: `WebhookController.cs:576-586`のTODO部分
  - Hangfireジョブ登録の実装
  - 見積: 0.5日（Takashi）
  - **申請却下リスク**: 高

- [ ] 🟡 **DBユニーク制約追加**
  - `WebhookEvents.IdempotencyKey`にユニークインデックス追加
  - 見積: 0.25日（Takashi）
  - **申請却下リスク**: 低（コード側で対応済み）

- [ ] 🔴 **E2E検証の実施**
  - Staging環境での4種Webhook動作確認
  - 証跡採取（ログ、スクリーンショット）
  - 見積: 0.5日（全員）
  - **申請却下リスク**: 中（未検証での不具合）

**参考**: `docs/00-production-release/03-gdpr-compliance/実装状況確認と対応方針.md`

---

### 1.3 セキュリティ要件

- [x] HTTPS強制が有効になっている
- [x] Content-Security-Policyヘッダーが適切に設定されている
  ```
  frame-ancestors https://*.myshopify.com https://admin.shopify.com
  ```
- [x] レート制限が実装されている（2リクエスト/秒）
- [x] SQLインジェクション対策が実装されている（EF Core使用）
- [x] XSS対策が実装されている（React自動エスケープ）

**確認方法**: 
- セキュリティヘッダーの確認（ブラウザ開発者ツール）
- レート制限の動作確認

**担当**: Takashi  
**見積**: 0.25日

---

### 1.4 API要件

- [x] Shopify APIバージョン2024-01以降を使用
- [x] GraphQL APIを使用（推奨）またはREST API
- [x] APIレート制限への対応（リトライ機構）
- [x] エラーハンドリングが適切に実装されている

**確認方法**: 
- APIバージョン確認（コード内）
- レート制限エラー時のリトライ動作確認

**担当**: Takashi  
**見積**: 0.25日

---

## 2. アプリ情報 📝 🔴

### 2.1 基本情報

- [ ] アプリ名（プライマリー言語）
  - 日本語: Shopify AIマーケティング分析スイート
  - 英語: Shopify AI Marketing Analytics Suite
- [ ] 🔴 **アプリの説明文（必須・100文字以上）**
  - [ ] 🔴 **英語版（必須・審査用）** - 審査チームが英語を使用するため
  - [ ] 日本語版（ターゲット市場が日本の場合に推奨）
- [ ] 🔴 **詳細な説明（必須・400文字以上）**
  - [ ] 🔴 **英語版（必須・審査用）** - 審査をスムーズに進めるため
  - [ ] 日本語版（ターゲット市場が日本の場合に推奨）
- [ ] 🔴 **審査用の説明文（Testing instructions）**
  - [ ] 英語版（必須・審査チームとのコミュニケーション用）
- [ ] カテゴリー選択（Analytics/Reportingなど）

**重要**: 
- **審査用の説明文は英語で記述することが強く推奨されます**
  - Shopifyの主要なレビューチームが英語を使用しているため
  - 英語で詳細に説明することで、審査がスムーズに進む可能性が高まります
- **アプリストア上の説明文も英語での提出が推奨されます**
  - 必須ではない場合もありますが、審査プロセスを円滑に進めるために推奨
- ターゲット市場が日本の場合、英語の説明文に加えて日本語の説明文も提供することが推奨されます
  - 日本のユーザーに対してより親しみやすく、理解しやすい情報を提供できます

**参考**: `docs/00-production-release/02-shopify-submission/アプリストア申請ガイド.md`

**担当**: マーケティング部門  
**見積**: 2-3日（英語版必須、日本語版推奨）

---

### 2.2 スクリーンショット 🔴

- [ ] アプリダッシュボードのスクリーンショット（最低5枚）
  - [ ] ダッシュボード画面
  - [ ] 売上分析画面
  - [ ] 顧客分析画面
  - [ ] 商品分析画面
  - [ ] 設定/課金画面
- [ ] 解像度: 1280x800px以上（推奨）
- [ ] モバイル対応のスクリーンショット（任意）

**参考**: `docs/00-production-release/02-shopify-submission/screenshot-guide.md`

**担当**: デザイン部門  
**見積**: 1日

---

### 2.3 アイコン・ロゴ 🔴

- [ ] アプリアイコン（1024x1024px、PNG形式）
- [ ] 背景透過処理済み
- [ ] Shopifyブランドガイドラインに準拠

**担当**: デザイン部門  
**見積**: 0.5日

---

## 3. 必須ドキュメント 📄

### 3.1 利用規約・データ処理契約 ✅

- [x] 利用規約ページが外部サイトに作成済み
  - URL: https://www.access-net.co.jp/shopify/terms.html
- [x] データ処理契約ページが外部サイトに作成済み
  - URL: https://www.access-net.co.jp/shopify/data-processing-agreement.html
- [x] アプリ内からアクセス可能（インストールページ・フッター）

**確認方法**: 
- インストールページでリンクが正しく動作することを確認
- フッターからリンクが正しく動作することを確認

**担当**: Kenji  
**見積**: 完了済み

---

### 3.2 プライバシーポリシー

- [x] プライバシーポリシーページが作成されている
  - 参考: `docs/00-production-release/10-legal/privacy-policy.md`
- [x] 収集するデータの明記
- [x] データの使用目的の明記
- [x] データ保存期間の明記
- [x] GDPR準拠の記載

**確認方法**: 
- プライバシーポリシーの内容が最新の実装と一致していることを確認

**担当**: 法務部門  
**見積**: 0.5日（レビュー）

---

### 3.3 サポート情報

- [ ] サポートメールアドレス（必須）
- [ ] サポートページURL（推奨）
- [ ] FAQ/ヘルプドキュメント（推奨・必須ではない）

**重要**: 
- サポートメールアドレスは**必須**です
- FAQ/ヘルプドキュメントは必須ではありませんが、ユーザー満足度向上のため**強く推奨**されます
- アプリの機能や設定方法を明確に説明することで、審査通過率も向上します

**担当**: サポート部門  
**見積**: 0.5日（メールアドレスのみ）、1-2日（ヘルプドキュメント含む）

---

### 3.4 デモサイト・デモストア 🟡

- [ ] デモサイトの準備（推奨・必須ではない）
- [ ] デモストアの設定（推奨・必須ではない）
- [ ] 審査用のテスト認証情報の準備（必須）

**重要**: 
- **デモサイトの作成は必須ではありませんが、強く推奨されます**
  - 審査担当者がアプリの機能を理解しやすくなる
  - 審査プロセスの円滑化が期待できる
  - 潜在的なユーザーがアプリの価値を理解しやすくなる
  - インストール率の向上が期待できる
- **既にデモモード機能が実装済み**（`/demo/login`、デモデータ表示など）
  - デモサイトを公開可能な状態にする必要がある
  - 審査用のテスト認証情報を提供する必要がある
- **開発ストアでのテストは必須**
  - ただし、審査チームに開発ストアの認証情報を提供する必要はありません
  - 審査チームは自分で開発ストアを作成するか、既存のテストストアを使用します

**実装状況**: 
- ✅ デモモード機能実装済み（`DemoModeMiddleware`、`DemoAuthController`）
- ✅ デモログインページ実装済み（`/demo/login`）
- ✅ デモデータ表示機能実装済み
- [ ] デモサイトの公開準備（本番環境でのデモモード有効化）
- [ ] 開発ストアの準備（必須）
- [ ] Testing instructionsの準備（必須）

**担当**: Takashi（デモサイト準備）、Kenji（開発ストア準備）、Yuki（スクリーンキャスト作成）  
**見積**: 0.5-1日（デモサイト公開準備）、0.5日（開発ストア準備）、1-2日（スクリーンキャスト作成）

---

## 4. アプリ機能要件 🔧

### 4.1 ユーザーエクスペリエンス

- [x] インストールが3クリック以内で完了
- [x] エラー時の適切なメッセージ表示
- [x] ローディング状態の表示
- [x] レスポンシブデザイン対応

**確認方法**: 
- 開発ストアでインストールフローを実際に実行
- エラーケースの動作確認

**担当**: Kenji  
**見積**: 0.5日

---

### 4.2 言語対応

- [x] 日本語対応
- [ ] 英語対応（部分的な実装）
- [ ] 言語切り替え機能（推奨）

**重要**: 
- **言語対応は必須ではありません**
- ただし、ターゲット市場に応じて適切な言語対応を行うことが**強く推奨**されます
- プライマリー言語（日本語）を決定し、アプリストア上の説明文は日本語で作成可能
- 英語対応は、グローバル展開を目指す場合に推奨されますが、日本市場のみをターゲットとする場合は後回しでも可

**確認方法**: 
- 英語環境での動作確認（英語対応する場合）

**担当**: Yuki  
**見積**: 1日（英語対応の完全化、必須ではない）

---

### 4.3 パフォーマンス

- [ ] 初回読み込みが3秒以内
- [ ] APIレスポンスが2秒以内
- [x] 大量データ処理時のページネーション

**確認方法**: 
- Chrome DevToolsのPerformanceタブで測定
- Application Insightsでパフォーマンスメトリクス確認

**担当**: Takashi  
**見積**: 0.5日（最適化）

---

## 5. テスト完了項目 ✓ 🔴

### 5.1 機能テスト

- [ ] OAuth認証フローの完全テスト
- [ ] 全ての分析機能の動作確認
- [ ] データ同期機能の確認
- [ ] エラーケースのテスト

**担当**: 全員  
**見積**: 1日

---

### 5.2 互換性テスト

- [ ] Chrome最新版での動作確認
- [ ] Safari最新版での動作確認
- [ ] モバイルブラウザでの確認
- [ ] Shopify管理画面内での動作確認

**担当**: Yuki  
**見積**: 0.5日

---

### 5.3 セキュリティテスト

- [ ] ペネトレーションテスト（推奨）
- [ ] OWASP Top 10の確認
- [ ] 脆弱性スキャン

**担当**: Takashi  
**見積**: 1日

---

## 6. 本番環境準備 🚀 🔴

### 6.1 インフラストラクチャ

- [x] Azure本番環境のセットアップ完了
- [x] SSL証明書の設定完了
- [ ] カスタムドメインの設定（任意）
- [ ] バックアップ体制の確立

**担当**: Takashi  
**見積**: 0.5日

---

### 6.2 監視・ログ

- [x] Application Insightsの設定
- [x] エラー監視の設定
- [x] パフォーマンス監視の設定
- [ ] アラート設定（重要エラー・パフォーマンス低下）

**担当**: Takashi  
**見積**: 0.5日

---

### 6.3 スケーラビリティ

- [ ] 自動スケーリングの設定
- [ ] 負荷テストの実施
- [ ] データベース最適化

**担当**: Takashi  
**見積**: 1日

---

## 7. Shopify Partners設定 🏪 🔴

### 7.1 アプリ登録

- [ ] Shopify Partnersアカウント作成
- [ ] アプリ作成・基本情報入力
- [ ] 🔴 **アプリURLの設定**（必須）
  - App URL: `https://[your-domain].com`
  - Redirect URLs:
    - `https://[your-domain].com/auth/callback`
    - `https://[your-domain].com/auth/success`
- [ ] OAuth設定（Redirect URLs）
- [ ] Webhook設定

**重要**: 
- **アプリURLはShopify Partners設定時に設定します**
  - これは審査用のテスト認証情報とは別物です
  - アプリURLはアプリのベースURLで、審査チームがアプリにアクセスする際に使用されます
- **審査用のテスト認証情報（開発ストアの認証情報）は別途準備が必要**です（セクション7.3参照）

**担当**: Kenji  
**見積**: 0.5日

---

### 7.2 料金プラン（該当する場合）

- [ ] 料金プランの設定
- [ ] 無料トライアル期間の設定
- [ ] 請求APIの実装

**確認方法**: 
- 課金システムの実装状況を確認
- 参考: `docs/00-production-release/04-billing-system/実装チェックリスト.md`

**担当**: Takashi  
**見積**: 1日（実装状況確認）

---

### 7.3 審査用テスト環境

- [ ] 🔴 **開発ストアの準備**（必須・申請者が準備）
  - [ ] Shopify Partnersで開発ストアを作成
  - [ ] 開発ストアにアプリをインストール
  - [ ] テストデータの投入（商品、顧客、注文など）
  - [ ] 全機能の動作確認
- [ ] 🔴 **Testing instructionsの準備**（必須）
  - [ ] サードパーティプラットフォームの認証情報（必要な場合）
  - [ ] スクリーンキャストの作成（強く推奨）
  - [ ] パフォーマンステスト結果の準備
  - [ ] 詳細な手順書の作成
- [ ] 🟡 **デモストアURLの提供**（推奨）
  - [ ] アプリがインストールされたデモストアへのリンクを準備

**重要**: 
- **開発ストアの準備は必須ですが、審査チームに開発ストアの認証情報（Store URL、Email、Password）を提供する必要はありません**
  - 審査チームは自分で開発ストアを作成するか、既存のテストストアを使用します
  - 審査チームはPartner Dashboardから開発ストアに直接アプリをインストールできます
- **審査チームの実際のテストフロー**:
  1. 審査チームが自身のテスト環境（開発ストア）を作成または使用
  2. Partner Dashboardからアプリをインストール
  3. アプリの機能をテスト
- **Testing instructionsで提供すべき実際の内容**:
  1. **サードパーティプラットフォームのログイン認証情報**（必要な場合）
     - アプリがマーケットプレイスなどの外部サービスと統合する場合
     - そのサービスの有効なテスト認証情報を提供（必須）
     - 認証情報は有効で、アプリの全機能へのフルアクセスを許可する必要がある
     - テストアカウントを提供しない場合、アプリ申請は却下される可能性がある
  2. **スクリーンキャスト**（強く推奨）
     - セットアップ過程と全機能のデモ
     - ステップバイステップの設定・使用方法
     - 外部設定の追加ステップ
     - 英語または英語字幕付き
  3. **パフォーマンステスト結果**
     - Lighthouseパフォーマンススコアへの影響のスクリーンショット
  4. **詳細な手順書**
     - アプリの設定方法と使用方法の明確な説明
- **デモストアURLの提供**（推奨）
  - アプリがインストールされたデモストアへのリンクを提供することで、マーチャントがアプリの動作を確認できます
  - 無料の開発ストアを使用できます

**準備手順**:
1. Shopify Partnersダッシュボードで開発ストアを作成
2. 開発ストアにアプリをインストール
3. テストデータを投入（商品、顧客、注文など）
4. 全機能が正常に動作することを確認
5. サードパーティサービスと統合している場合、テスト認証情報を準備
6. スクリーンキャストを作成（セットアップと全機能のデモ）
7. パフォーマンステスト結果を準備
8. 詳細な手順書を作成
9. 申請フォームの「Testing instructions」に上記情報を記載

**参考**: Shopify公式ドキュメント（最新情報）

**担当**: Kenji（開発ストア準備）、Yuki（スクリーンキャスト作成）、Takashi（パフォーマンステスト）  
**見積**: 0.5日（開発ストア準備）、1-2日（スクリーンキャスト作成）、0.5日（パフォーマンステスト・手順書作成）

---

## 8. 申請プロセス 📮

### 8.1 申請前の最終確認

- [ ] 全ての必須項目がチェック済み
- [ ] テスト環境での最終動作確認
- [ ] ドキュメントの最終レビュー

**担当**: 全員  
**見積**: 0.5日

---

### 8.2 申請手順

1. [ ] Shopify Partnersダッシュボードにログイン
2. [ ] アプリ情報の最終確認
3. [ ] 「Submit for review」をクリック
4. [ ] 追加情報の入力（必要に応じて）
5. [ ] 申請完了

**担当**: Kenji  
**見積**: 0.5日

---

### 8.3 申請後の対応

- [ ] 審査結果の通知を待つ（通常3-5営業日）
- [ ] フィードバックへの迅速な対応準備
- [ ] 修正要求への対応体制

**担当**: 全員  
**見積**: 継続的

---

## 📊 進捗管理

### 全体進捗

| カテゴリ | 完了度 | 残作業 |
|---------|--------|--------|
| **技術要件** | 85% | 本番スケジューリング、E2E検証 |
| **アプリ情報** | 0% | 説明文（英語版必須・日本語版推奨）、アイコン、スクリーンショット作成必要 |
| **必須ドキュメント** | 90% | サポートメールアドレス（必須）、ヘルプドキュメント（推奨） |
| **アプリ機能要件** | 80% | 英語対応、パフォーマンス最適化 |
| **テスト** | 20% | 全テスト実施必要 |
| **本番環境準備** | 70% | 監視・スケーラビリティ |
| **Shopify Partners設定** | 0% | 全て設定必要 |

### 重要タスクの優先順位

1. 🔴 **本番削除スケジューリング実装**（0.5日）
2. 🔴 **E2E検証実施**（0.5日）
3. 🔴 **申請素材準備**（アイコン、スクリーンショット、説明文）（2-3日）
   - アプリストア上の説明文は**英語版が必須**（審査用）
   - 日本語版はターゲット市場が日本の場合に推奨
4. 🔴 **Shopify Partners設定**（0.5日）
5. 🔴 **サポートメールアドレス設定**（必須・0.5日）
6. 🔴 **開発ストアの準備**（必須・0.5日）
   - 開発ストアの作成とアプリのインストール
   - テストデータの投入
   - 全機能の動作確認
7. 🔴 **Testing instructionsの準備**（必須・1-2日）
   - サードパーティプラットフォームの認証情報（必要な場合）
   - スクリーンキャストの作成（強く推奨）
   - パフォーマンステスト結果の準備
   - 詳細な手順書の作成
8. 🟡 **デモストアURLの提供**（推奨・0.25日）
   - アプリがインストールされたデモストアへのリンクを準備
9. 🟡 **デモサイトの公開準備**（推奨・0.5-1日）
   - 既にデモモード機能は実装済み
   - 本番環境でのデモモード有効化と公開準備
10. 🟡 **ヘルプドキュメント作成**（推奨・1-2日）
11. 🟡 **アプリ内の英語対応**（推奨・必須ではない・1日）
   - アプリストア上の説明文は英語必須だが、アプリ内UIの英語対応は必須ではない
12. 🟡 **パフォーマンス最適化**（0.5日）
13. 🟡 **セキュリティテスト**（1日）

---

## 🚨 リスク管理

### よくある却下理由と対策

| 却下理由 | 対策 | 状態 |
|---------|------|------|
| **セキュリティ要件の不備** | HTTPS強制、HMAC検証、CSPヘッダー設定 | ✅ 対応済み |
| **GDPR対応の不備** | 必須Webhook実装、データ削除機能 | 🟡 本番スケジューリング残存 |
| **ユーザーエクスペリエンス** | インストールプロセス、エラーメッセージ | ✅ 対応済み |
| **申請素材不足** | アイコン、スクリーンショット、説明文 | 🔴 未準備 |
| **パフォーマンス問題** | レスポンス時間短縮、キャッシュ実装 | 🟡 最適化必要 |

---

## 📅 推奨スケジュール

### 最短スケジュール（2週間）

```
Week 1:
- Day 1-2: 本番スケジューリング実装、E2E検証
- Day 3-4: 申請素材準備（アイコン、スクリーンショット）
- Day 5: 説明文作成、Shopify Partners設定

Week 2:
- Day 1-2: 英語対応、パフォーマンス最適化
- Day 3: セキュリティテスト、最終確認
- Day 4-5: 申請提出、審査対応準備
```

### 現実的なスケジュール（3-4週間）

```
Week 1: 技術要件の完了（本番スケジューリング、E2E検証）
Week 2: 申請素材準備（アイコン、スクリーンショット、説明文）
Week 3: 機能改善（英語対応、パフォーマンス最適化）
Week 4: テスト・最終確認・申請提出
```

---

## ✅ 完了基準

### 申請提出可能な状態

- [ ] 全ての🔴最優先タスクが完了
- [ ] E2E検証が完了し、証跡が揃っている
- [ ] 申請素材（アイコン、スクリーンショット、説明文）が準備済み
- [ ] Shopify Partners設定が完了
- [ ] 本番環境での動作確認が完了

### 申請成功を目指す状態

- [ ] 全ての🟡重要タスクも完了
- [ ] セキュリティテストが完了
- [ ] パフォーマンス最適化が完了
- [ ] 英語対応が完全化

---

## 📞 連絡先・リソース

### 参考ドキュメント

- 申請ガイド: `docs/00-production-release/02-shopify-submission/アプリストア申請ガイド.md`
- GDPR実装状況: `docs/00-production-release/03-gdpr-compliance/実装状況確認と対応方針.md`
- 課金システム: `docs/00-production-release/04-billing-system/実装チェックリスト.md`
- スクリーンショットガイド: `docs/00-production-release/02-shopify-submission/screenshot-guide.md`

### Shopify公式リソース

- [Shopify App Store Requirements](https://shopify.dev/docs/apps/store/requirements)
- [Shopify Partners Dashboard](https://partners.shopify.com)
- [App Review Guidelines](https://shopify.dev/docs/apps/store/review)

---

**最終更新**: 2025-10-18  
**次回更新予定**: タスク完了時

