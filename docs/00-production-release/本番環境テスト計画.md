# 本番環境テスト計画

> 目的: 公開前に必須の通し・コンプライアンス・設定テストを実施し、証跡を残す
> 参照: `./RELEASE-CHECKLIST.md`, `./shopify-submission/申請チェックリスト.md`, `./shopify-submission/アプリストア申請ガイド.md`, `./shopify-submission/shopify-審査対策完全ガイド.md`
> 証跡保管: `./evidence/` にスクショ/録画/ログを保存

---

## テスト一覧

| テスト項目 | 内容 | 目的 | 手順出典 | 証跡 | 担当 | 期限 |
|------------|------|------|----------|------|------|------|
| 新規課金フロー（TEST/$0.00） | プラン選択→承認URL→承認→Webhook反映→機能解放 | 課金の主要動線確認 | 申請ガイド/審査対策 | 画面録画/ログ | 福田 | 9/8週 |
| アップグレード/キャンセル | プラン変更/解約時の状態遷移 | 課金イベントの正当性 | 申請ガイド/審査対策 | 画面録画/ログ | 福田 | 9/8週 |
| アンインストール→課金キャンセル | app/uninstalled で請求停止 | 二重請求防止 | 審査対策 | ログ/DB記録 | 福田 | 9/8週 |
| 無料プラン（課金なし） | 休眠顧客のみアクセス可、未選択時の導線 | ゲート挙動の確認 | 申請チェックリスト | スクショ/録画 | 福田 | 9/8週 |
| GDPR 3種＋再送冪等 | data_request/redact/shop_redact 再送順序入替 | コンプライアンス | 審査対策 | ログ/追跡ID | 福田 | 9/8週 |
| CSP / 埋め込み表示 | frame-ancestors 設定・App内表示 | 審査要件 | 申請チェックリスト | レスポンスヘッダ | 福田 | 9/8週 |
| 開発用ルート遮断 | 本番で /dev 等が不可 | セキュリティ | 議事録(8/18) | アクセス結果 | 福田 | 9/8週 |
| マイグレーション適用/戻し | 適用/ロールバック手順の検証 | 安定運用 | tracking.md | 手順書更新 | 福田 | 9/8週 |

---

## 実施ルール
- 冪等性検証: 再送/順序入替/タイムアウトを想定しログに相関IDを付与
- 証跡: すべてのテストでスクリーンショットまたは録画必須。ログはタイムスタンプ付きで保存
- 合格基準: エラー0、必要ログ出力、UI反映、Webhook処理完了までをもって合格

---

## 報告
- 実施結果は `申請準備状況レポート.md` の該当節に反映
- 重大な不具合は `RELEASE-CHECKLIST.md` の該当項目を未達に戻し、影響/対処/再テスト日を追記
